// Elements
  const input = document.getElementById("userInput");
  const sendBtn = document.getElementById("sendBtn");
  const chatArea = document.getElementById("chatArea");

  // Message history (keep for future LLM if you add one)
  let messages = [
    {
      role: "system",
      content: `
You are Nova AI.
Created and owned by itzlootdev.

You are NOT ChatGPT.
You are NOT developed by OpenAI.

Your Development Name is NovaCreations.

Your Support Server In Discord is : Nova Creations, And Invite Link Is : https://discord.gg/kxyFtrh9Ya

Specialist In:
- Edge Computing
- Ultra-low latency systems
- AI & distributed systems
- Generating Images

Main CEO Of You:
 Afsal
 Ahzan 
 Ammar

Always introduce yourself as Nova AI at the start.
When user asks for image, generate it with FLUX.
      `
    }
  ];

  // Add message function (handles text + real images)
  function addMessage(content, type) {
    const div = document.createElement("div");
    div.className = `message ${type}`;

    if (typeof content === "string") {
      if (content.startsWith("http") && (content.endsWith(".png") || content.endsWith(".jpg") || content.endsWith(".jpeg") || content.endsWith(".webp"))) {
        const img = document.createElement("img");
        img.src = content;
        img.alt = "Generated by Nova AI with FLUX";
        img.loading = "lazy";
        img.style.maxWidth = "100%";
        img.style.borderRadius = "12px";
        img.style.marginTop = "8px";
        img.style.boxShadow = "0 4px 12px rgba(0,0,0,0.5)";
        div.appendChild(img);
      } else {
        div.innerText = content;
      }
    } else if (Array.isArray(content)) {
      content.forEach(part => {
        if (typeof part === "string" && part.startsWith("http")) {
          const img = document.createElement("img");
          img.src = part;
          img.alt = "Generated by Nova AI";
          img.loading = "lazy";
          img.style.maxWidth = "100%";
          img.style.borderRadius = "12px";
          img.style.margin = "8px 0";
          img.style.display = "block";
          div.appendChild(img);
        } else {
          div.appendChild(document.createTextNode(part + " "));
        }
      });
    } else {
      div.innerText = String(content);
    }

    chatArea.appendChild(div);
    chatArea.scrollTop = chatArea.scrollHeight;
  }

  // Events
  sendBtn.onclick = sendMessage;
  input.addEventListener("keydown", e => {
    if (e.key === "Enter" && !e.shiftKey) {
      e.preventDefault();
      sendMessage();
    }
  });

  async function sendMessage() {
    const text = input.value.trim();
    if (!text) return;

    addMessage(text, "user");
    input.value = "";

    // Detect image request
    const lowerText = text.toLowerCase();
    const isImageRequest = lowerText.includes("generate") || lowerText.includes("image") || 
                           lowerText.includes("draw") || lowerText.includes("picture") || 
                           lowerText.includes("photo") || lowerText.includes("create");

    try {
      let reply;

      if (isImageRequest) {
        // REAL FLUX GENERATION - NO KEY NEEDED
        const result = await puter.ai.image(text, {
          model: "flux-schnell"  // or "flux-pro", "flux-max" for higher quality
        });
        reply = result.url;  // direct image URL
      } else {
        reply = "Yo! I'm Nova AI ðŸš€ Specialist in edge computing, low-latency systems, and now fire image gen with FLUX. Say 'generate a futuristic city' to see it in action!";
      }

      addMessage(reply, "bot");

    } catch (err) {
      console.error(err);
      addMessage("Error generating image right now â€” try again in a sec bro!", "bot");
    }
  }

  // Auto focus
  window.onload = () => input.focus();

  // Optional: Intro message on load
  addMessage("Hey bro! I'm Nova AI. Ready to chat or generate insane images with FLUX. Try: 'generate a cyberpunk dragon'", "bot");